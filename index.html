<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Расписание</title>

<style>
body {
   margin: 0;
   padding: 40px;
   background: black;
   color: white;
   font-family: Arial, sans-serif;
}

h1 {
   text-align: center;
   font-size: 48px;
   margin-bottom: 40px;
}

table {
   width: 100%;
   border-collapse: collapse;
   font-size: 28px;
}
th, td {
   padding: 15px;
   border-bottom: 1px solid #333;
   text-align: left;
}
</style>
</head>

<body>

<h1>РАСПИСАНИЕ НА СЕГОДНЯ</h1>
<table id="table"></table>

<script>
const sheetUrl = "https://docs.google.com/spreadsheets/d/1ohF6YdYSHyxjXujSa5nkrxAdMztpd87TFQ-sGqWdCs8/edit?usp=sharing";

async function loadSchedule() {
  try {
    const res = await fetch(sheetUrl + "&t=" + Date.now());
    const text = await res.text();
    const rows = text.split("\n").map(r => r.split(","));

    let html = "<tr>";
    rows[0].forEach(h => html += `<th>${h}</th>`);
    html += "</tr>";

    for (let i = 1; i < rows.length; i++) {
      if(rows[i].length < 2) continue;
      html += "<tr>";
      rows[i].forEach(col => html += `<td>${col}</td>`);
      html += "</tr>";
    }

    document.getElementById("table").innerHTML = html;

  } catch (error){
    document.getElementById("table").innerHTML =
      "<tr><td>Ошибка загрузки данных</td></tr>";
  }
}

loadSchedule();
setInterval(loadSchedule, 30000); // обновление раз в 30 сек
</script>

</body>
</html>
